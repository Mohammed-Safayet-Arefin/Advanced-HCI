{% extends 'base.html' %}

{% block header %}
  <!-- <link href="dashboard.css" rel="stylesheet"> -->
  <link href="{{ url_for('static', filename='css/dashboard.css') }}" rel="stylesheet">
  <link href="{{ url_for('static', filename='css/schedule.css') }}"  rel="stylesheet"> <!-- style for worker schedule-->
  <link href="{{ url_for('static', filename='css/sidebar.css') }}" rel="stylesheet">
  <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
  <!-- <h1>{% block title %}Jobs{% endblock %}</h1> -->
  <!-- {% if g.user %}
    <a class="action" href="{{ url_for('dashboard.create') }}">New</a>
  {% endif %} -->
{% endblock %}

{% block content %}

<div class="container-fluid">
    <div class="dashboard-body">
      <div class="row">

        <div class="page-wrapper chiller-theme toggled">
        <a id="show-sidebar" class="btn btn-sm btn-dark" href="#">
            <i class="fas fa-bars"></i>
        </a>
        <nav id="sidebar" class="col-md-2 col-lg-2 d-md-block sidebar-wrapper">
            <div class="sidebar-content">
                <div class="sidebar-header">
                    <div class="user-pic">
                        <img class="img-responsive img-rounded" src="{{ url_for('static', filename='images/user_avatar.jpg') }}" alt="User picture">
                    </div>
                    <div class="user-info">
                        <span class="user-name">
                          <a href="{{ url_for('dashboard.user_profile') }}">
                          {{session['username']}}
                        </span>
                        <span class="user-role">Flexible Worker</span><br>
                        <span class="user-status">
                            <span class="onlineIcon" data-feather="circle"></span>
                            <span>Online</span>
                        </span>
                    </div>
                </div>
             

                <!-- sidebar-search  -->
                <div class="sidebar-menu">
                    <ul>
                        
                        <li>
                            <a href="{{ url_for('dashboard.index') }}">
                                <span data-feather="layout"></span>
                                <span>Dashboard</span>
                            </a>
                        </li>
                        <li>
                           <a href="https://accounts.google.com/signin/v2/sl/pwd?service=CPanel&flowName=GlifWebSignIn&flowEntry=ServiceLogin">
                                <span data-feather="inbox"></span>
                                <span>Inbox</span>
                                <span class="badge badge-pill badge-danger">3 New</span>
                            </a>
                       </li>
                        <li>
                            <a href="{{ url_for('dashboard.available_jobs') }}">
                                <span data-feather="clipboard"></span>
                                <span>Available Jobs</span>
                                <span class="badge badge-pill badge-primary">98</span>
                      
                            </a>
                        </li>
                        <li>
                            <a href="{{ url_for('dashboard.claimed_jobs', e_id=session['u_id'])}}">
                                <span data-feather="briefcase"></span>
                                <span>Claimed Jobs</span><span class="badge badge-pill badge-primary">12</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.google.com/maps">
                                 <span data-feather="map"></span>
                                <span>Live Maps</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.google.com/calendar">
                                <span data-feather="calendar"></span>
                                <span>Calendar</span>
                            </a>
                        </li>
                        <li>
                            <a href="{{ url_for('dashboard.user_schedule') }}">
                                <span data-feather="list"></span>
                                <span>Schedule</span>
                            </a>
                        </li>
                        <li>
                            <a href="{{url_for('dashboard.documentation')}}">
                                 <span data-feather="book"></span>
                                <span>Documentation</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <!-- sidebar-menu  -->
            </div>
            <!-- sidebar-content  -->
            <div class="sidebar-footer">
                <a href="#">
                    <span data-feather="bell"></span>
                    <span class="badge badge-pill badge-warning notification">3</span>
                </a>
                <a href="#">
                    <span data-feather="mail"></span>
                    <span class="badge badge-pill badge-success notification">7</span>
                </a>
                <a href="#">
                    <span data-feather="settings"></span>
                    <span class="badge-sonar"></span>
                </a>
                <a href="#">
                    <i class="fa fa-power-off"></i>
                </a>
            </div>
        </nav>
        <!-- sidebar-wrapper  -->
      </div>
                <!-- sidebar-menu  -->
         <main role="main" class="col-lg-10 col-md-12 ml-sm-auto  px-4">
  

          <div class="row"> 
            <div class="col-lg-8 col-md-12 col-sm-12">

            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                  <h4>{{session['username']}}'s Claimed Jobs</h4>
            </div>
           

            <div class="row">    
              <div class="col-lg-8 col-md-12 col-sm-12 col-xs-12 search-bar ">
              <div class="input-group">
                      <input type="hidden" name="search_param" value="all" id="search_param">         
                      <input id="search-input" type="text" class="form-control" name="x" placeholder="Search Jobs">
                      <div class="input-group-btn search-panel">
                          <button id="search-bar-dropdown" type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                            <span id="search_concept">Filter by</span> <span class="caret"></span>
                          </button>
                          <ul class="dropdown-menu" role="menu">
                            <li class="dropdown-item"><a href="#Location">Location</a></li>
                            <li class="dropdown-item"><a href="#Day">Day of the Week</a></li>
                            <li class="dropdown-item"><a href="#Qualifications">Qualification</a></li>
                            <li class="dropdown-item"><a href="#Time">Time of Day</a></li>
                          </ul>
                      </div>
              </div>
              </div>
              <div class="col-lg-4 col-md-12 col-sm-12 col-xs-12">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-1 mb-3">
                <button class="btn btn-block btn-sm btn-outline-secondary">
                <span data-feather="filter"></span> Advanced Filter</button>
              </div>
              </div>
          </div>

              <div class="table-responsive">
                <table class="table table-striped table-sm">
                  <thead>
                    <tr>
                      <th>Job ID</th>
                      <th>Title</th>
                      <th>Location</th>
                      <th>Start Time</th>
                      <th>End Time</th>
                      <th>Qualifications</th>
                      <th>Return Job<th>
                    </tr>
                  </thead>
                  <tbody>

                    {% for job in jobs %}
                      <tr>
                        <td>{{ job['job_id'] }}</td>
                        <td>{{ job['job_title'] }}</td>
                        <!-- <td>{{ job['job_desc'] }}</td> -->
                        <td>{{ job['job_city']}}, {{job['job_state']}}</td>
                        <td>{{ job['job_time_beg']}}</td>
                        <td>{{ job['job_time_end']}}</td>
                        <td><button class="btn btn-sm btn-dark qualification-tags">{{job['job_credentials']}}</button></td>
                        <td> <button type="button" class="btn btn-sm btn-outline-primary edit-btn" onclick="return confirm('Are you sure you want to return job to jobs Queue? You will no longer be scheduled for this job.')">Return</button></td>
                      </tr>
                    {% endfor %}

                    <tr data-toggle="collapse" href="#collapse1">
                      <td>1000</td>
                      <td>Courier Delivery</td>
                      <td>Jackson, MS</td>
                      <td>15:00</td>
                      <td>18:00</td>
                      <td>
                          <button class="btn btn-sm btn-dark qualification-tags">CDL License</button>
                          <button class="btn btn-sm btn-dark qualification-tags">Standard Emp</button></td>
                    
                      <td><button type="button" class="btn btn-sm btn-outline-primary edit-btn" data-toggle="modal" data-target="#exampleModal">Return</button></td>
                    </tr>

                    <tr >
                      <td colspan="7" style="margin: 0; padding: 0; border-top: none; border-left: 1px solid lightgrey">
                        <div class="panel-group">
                        <div class="panel panel-default">
                          <div id="collapse1" class="panel-collapse collapse">
                            <div class="panel-body">
                              <div class="row">
                              <div class="col-lg-4 panel-data">
                                  <p><strong>Job ID</strong>: 1000</p>
                                  <p><strong>Job Title</strong>: Delivery #3419</p>
                                  <p><strong>Job Description</strong>: Deliver Packages from Starkville, MS to Jackson, MS. Estimated Time is 3hrs.</p>
                                   <p><strong>Qualification Requirements</strong><br>
                                    <button class="btn btn-sm btn-dark qualification-tags">CDL License</button>
                                    <button class="btn btn-sm btn-dark qualification-tags">Standard Emp</button>
                                    </p>
                                  <button type="button" class="btn btn-sm btn-info claim-btn" data-toggle="modal" data-target="#exampleModal">Return</button>
                                  </div>

                              <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                              <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                  <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel"><p>Courier Delivery #3419</p></h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                      <span aria-hidden="true">&times;</span>
                                    </button>
                                  </div>
                                  <div class="modal-body">
                        
                                    <!-- <p><strong>Job Title</strong>: CourierDelivery #3419</p> -->
                                    <p><strong>Duration</strong>: 3hrs</p>
                                    <p><strong>Date:</strong> Nov. 06, 2018 9:00AM - 12:00PM</p>
                                    <p><strong>Location</strong>: Starkville, MS to Jackson, MS</p>
                                    <p><strong>Job Description</strong>: Deliver Packages from Starkville, MS to Jackson, MS. Estimated Time is 3hrs.</p>
                                    <p><strong>Qualification Requirements</strong><br>
                                    <button class="btn btn-sm btn-dark qualification-tags">CDL License</button>
                                    <button class="btn btn-sm btn-dark qualification-tags">Standard Emp</button>

                                    <div id="map_placeholder"><img src="{{ url_for('static', filename='images/map_placeholder.jpg') }}"></div>
                                  </div>
                                  <div class="modal-footer">

                                    <button type="button" class="btn btn-sm btn-outline-secondary" data-dismiss="modal">Cancel</button>
                                    <button type="button" class="btn btn-sm btn-outline-primary" data-dismiss="modal" onclick="return confirm('Are you sure you want to claim this job');">
                                     Claim Job
                                   </button>
                                   
                                  </div>
                                </div>
                              </div>
                            </div>

                              <div class="col-lg-8">
                                <div id="map"></div>
                              </div>

                            </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      </td>
                    </tr>

                    <tr data-toggle="collapse" href="#collapse2">
                       <td>1000</td>
                      <td>Handler</td>
                      <td>Starkville, MS</td>
                      <td>09:00</td>
                      <td>12:00</td>
                      <td>
                          <button class="btn btn-sm btn-dark qualification-tags">CDL License</button>
                      </td>
                       
                      <td><button type="button" class="btn btn-sm btn-outline-primary edit-btn" data-toggle="modal" data-target="#exampleModal">Return</button></td>
                    </tr>

                    <tr >
                      <td colspan="7" style="margin: 0; padding: 0; border-top: none">
                        <div class="panel-group">
                        <div class="panel panel-default">
                          <div id="collapse2" class="panel-collapse collapse">
                            <div class="panel-body">
                              <div class="row">
                              <div class="col-lg-4">
                                  <p><strong>Job ID</strong>: 1000</p>
                                  <p><strong>Job Title</strong>: Delivery #3419</p>
                                  <p><strong>Job Description</strong>: Deliver Packages from Starkville, MS to Jackson, MS. Estimated Time is 3hrs.</p>
                                   <p><strong>Qualification Requirements</strong><br>
                                     <button class="btn btn-sm btn-dark qualification-tags">CDL License</button>
                                    </p>
                                  <button class="btn btn-sm btn-info claim-btn">Return</button>
                                  </div>

                              <div class="col-lg-8">
                                  <div id="map_placeholder"><img src="{{ url_for('static', filename='images/map_placeholder.jpg') }}"></div>
                              </div>
                            </div>
                            
                            </div>
                          </div>
                        </div>
                      </div>
                      </td>
                    </tr>
                  </tbody></table>
              </div>
          </div> <!-- End column -->
          <hr>
    
      </main>


      </div>
      </div>
    </div>
  

    <!-- Icons -->
    <script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script>
    <script>
      feather.replace()
    </script>

    <script type="text/javascript">

      // For Search Bar Dropdown Menu 
      $(document).ready(function(e){
          $('.search-panel .dropdown-menu').find('a').click(function(e) {
          e.preventDefault();
          var param = $(this).attr("href").replace("#","");
          var concept = $(this).text();
          $('.search-panel span#search_concept').text(concept);
          $('.input-group #search_param').val(param);
        });
      });

       // Initialize and add the map
        function initMap() {
          // The location of Uluru
          var uluru = {lat: 33.45, lng: -88.81};
          // The map, centered at Uluru
          var map = new google.maps.Map(
              document.getElementById('map'), {zoom: 10, center: uluru});
          // The marker, positioned at Uluru
          var marker = new google.maps.Marker({position: uluru, map: map});
        }
    </script>

    <!-- <script>
        // Initialize and add the map
        function initMap() {
          // The location of Uluru
          var uluru = {lat: 33.45, lng: -88.81};
          // The map, centered at Uluru
          var map = new google.maps.Map(
              document.getElementById('map'), {zoom: 10, center: uluru});
          // The marker, positioned at Uluru
          var marker = new google.maps.Marker({position: uluru, map: map});
        }
    </script> -->
    <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB3xgRhqhD3SevqR4b5DtJ-gau7bVB4tvI&callback=initMap">
    </script>


{% endblock %}